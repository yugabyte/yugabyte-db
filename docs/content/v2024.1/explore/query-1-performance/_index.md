---
title: Query Tuning
headerTitle: Query Tuning
linkTitle: Query tuning
description: Tuning and optimizing query performance
headcontent: Optimize query performance
menu:
  v2024.1:
    identifier: query-tuning
    parent: explore
    weight: 300
type: indexpage
showRightNav: true
---

Query tuning is the art and science of improving the performance of SQL queries. It involves understanding the database's architecture, query execution plans, and performance metrics. By identifying and addressing performance bottlenecks, you can significantly enhance the responsiveness of your applications and reduce the load on your database infrastructure.

This guide provides a comprehensive overview of query tuning techniques for distributed SQL databases. We will explore various strategies, best practices, and tools to help you optimize your queries and achieve optimal performance.

## Identify slow queries

The pg_stat_statements extension provides a comprehensive view of query performance, and is essential for database administrators and developers aiming to enhance database efficiency. You can use the pg_stat_statements extension to get statistics on past queries. It collects detailed statistics on query execution, including the number of executions, total execution time, and resource usage metrics like block hits and reads. This data can help ypu identify performance bottlenecks and optimize query performance.

{{<lead link="./pg-stat-statements/">}}
Learn how to fetch query statistics and improve performance using [pg_stat_statements](./pg-stat-statements/).
{{</lead>}}

## Column statistics

The pg_stats view provides a user-friendly display of the column-level data distribution of tables. This view includes information about table columns, such as the fraction of null entries, average width, number of distinct values, and most common values. These statistics are crucial for the query planner to make informed decisions about the most efficient way to execute queries. By regularly analyzing the statistics in pg_stats, you can identify opportunities for optimization, such as creating or dropping indexes, and fine-tune your database configuration for optimal performance.

{{<lead link="./pg-stats/">}}
Learn how to understand column level statistics and improve query performance using [pg_stats](./pg-stats/).
{{</lead>}}

## View plans with EXPLAIN

Use the EXPLAIN statement to show the query execution plan generated by YugabyteDB for a given SQL statement. Using EXPLAIN, you can discover where in the query plan the query is spending most of its time, and with this information, decide on the best approach for improving query performance. This could include strategies such as adding an index or changing index sort order.

{{<lead link="./explain-analyze/">}}
Learn about [analyzing queries with EXPLAIN](./explain-analyze/).
{{</lead>}}

## Use a hint plan

Using the pg_hint_plan extension, you can influence the query planner's decisions by embedding hints directly in SQL comments. This can be particularly useful when the planner's default behavior doesn't align with the specific performance needs of a query. Using hints, such as specifying join methods or scan types, you can guide the planner to choose more efficient execution plans based on your knowledge of the data and workload.

{{<lead link="./pg-hint-plan/">}}
To learn more, see [Optimizing YSQL queries using pg_hint_plan](./pg-hint-plan/).
{{</lead>}}

## Log all slow queries

You can set the `--ysql_log_min_duration_statement` flag to help track down slow queries. When configured, YugabyteDB logs the duration of each completed SQL statement that runs the specified duration (in milliseconds) or longer. (Setting the value to 0 prints all statement durations.)
You can set the `--ysql_log_min_duration_statement` flag to help track down slow queries. When configured, YugabyteDB logs the duration of each completed SQL statement that runs the specified duration (in milliseconds) or longer. (Setting the value to 0 prints all statement durations.)

```sh
$ ./bin/yb-tserver --ysql_log_min_duration_statement 1000
```

Results are written to the current `postgres*log` file.

{{< note title="Note" >}}

Depending on the database and the work being performed, long-running queries don't necessarily need to be optimized.

Ensure that the threshold is high enough so that you don't flood the `postgres*log` log files.

{{< /note >}}

{{<lead link="/preview/troubleshoot/nodes/check-logs/#yb-tserver-logs">}}
Learn more about [YB-TServer logs](/preview/troubleshoot/nodes/check-logs/#yb-tserver-logs).
{{</lead>}}
