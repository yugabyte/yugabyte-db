---
title: Query Tuning
headerTitle: Query tuning
linkTitle: Query tuning
description: Tuning and optimizing query performance
headcontent: Optimize query performance
aliases:
  - /stable/explore/query-1-performance/query-tuning-intro/
menu:
  stable:
    identifier: query-tuning
    parent: monitor-and-alert
    weight: 300
type: indexpage
showRightNav: true
---

Query tuning is the art and science of improving the performance of SQL queries. It involves understanding the database's architecture, query execution plans, and performance metrics. By identifying and addressing performance bottlenecks, you can significantly enhance the responsiveness of your applications and reduce the load on your database infrastructure.

This guide provides an overview of query tuning techniques for distributed SQL databases, including strategies, best practices, and tools to help you optimize queries, and achieve optimal performance.

## Identify slow queries

The pg_stat_statements extension provides a comprehensive view of query performance, and is essential for database administrators and developers aiming to enhance database efficiency. You can use the pg_stat_statements extension to get statistics on past queries. It collects detailed statistics on query execution, including the number of executions, total execution time, and resource usage metrics like block hits and reads. This data can help you identify performance bottlenecks and optimize query performance.

{{<lead link="./pg-stat-statements/">}}
Learn how to fetch query statistics and improve performance using [pg_stat_statements](./pg-stat-statements/).
{{</lead>}}

## Column statistics

The pg_stats view provides a user-friendly display of the column-level data distribution of tables. This view includes information about table columns, such as the fraction of null entries, average width, number of distinct values, and most common values. These statistics are crucial for the query planner to make informed decisions about the most efficient way to execute queries. By regularly analyzing the statistics in pg_stats, you can identify opportunities for optimization (such as creating or dropping indexes), and fine-tune your database configuration for optimal performance.

{{<lead link="./pg-stats/">}}
Learn how to understand column level statistics and improve query performance using [pg_stats](./pg-stats/).
{{</lead>}}

## View plans with EXPLAIN

Use the EXPLAIN statement to show the query execution plan generated by YugabyteDB for a given SQL statement. Using EXPLAIN, you can discover where in the query plan the query is spending most of its time, and with this information, decide on the best approach for improving query performance. This could include strategies such as adding an index or changing index sort order.

{{<lead link="./explain-analyze/">}}
Learn about [analyzing queries with EXPLAIN](./explain-analyze/).
{{</lead>}}

## Use a hint plan

Using the pg_hint_plan extension, you can influence the query planner's decisions by embedding hints directly in SQL comments. This can be particularly useful when the planner's default behavior doesn't align with the specific performance needs of a query. Using hints, such as specifying join methods or scan types, you can guide the planner to choose more efficient execution plans based on your knowledge of the data and workload.

{{<lead link="./pg-hint-plan/">}}
To learn more, see [Optimizing YSQL queries using pg_hint_plan](./pg-hint-plan/).
{{</lead>}}

## Log all slow queries

You can set the `--ysql_log_min_duration_statement` flag to help track down slow queries. When configured, YugabyteDB logs the duration of each completed SQL statement that runs the specified duration (in milliseconds) or longer. (Setting the value to 0 prints all statement durations.)

```sh
$ ./bin/yb-tserver --ysql_log_min_duration_statement 1000
```

Results are written to the current `postgres*log` file.

(Depending on the database and the work being performed, long-running queries don't necessarily need to be optimized. Ensure that the threshold is high enough so that you don't flood the `postgres*log` log files.)

{{<lead link="/stable/explore/observability/logging/">}}
Learn more about [YB-TServer logs](/stable/explore/observability/logging/).
{{</lead>}}

## Auto Analyze

To create optimal plans for queries, the query planner needs accurate and up-to-date statistics related to tables and their columns. ANALYZE collects statistics about the contents of tables in the database, and stores the results in the `pg_statistic` system catalog. Similar to [PostgreSQL autovacuum](https://www.postgresql.org/docs/current/routine-vacuuming.html#AUTOVACUUM), the YugabyteDB Auto Analyze service automates the execution of ANALYZE commands for any table where rows have changed more than a configurable threshold for the table. This ensures table statistics are always up-to-date.

{{<lead link="../../../additional-features/auto-analyze/">}}
To learn more, see [Auto Analyze service](../../../additional-features/auto-analyze/).
{{</lead>}}

## Export query diagnostics

Capture and export detailed query diagnostic information across multiple dimensions to help identify and resolve database query problems.

{{<lead link="./query-diagnostics/">}}
To learn more, see [Query diagnostics](./query-diagnostics/).
{{</lead>}}
