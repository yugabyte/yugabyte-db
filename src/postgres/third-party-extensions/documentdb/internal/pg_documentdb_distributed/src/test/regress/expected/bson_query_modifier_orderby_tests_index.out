SET search_path TO documentdb_core,documentdb_api,documentdb_api_catalog,documentdb_api_internal;
SET citus.next_shard_id TO 3500000;
SET documentdb.next_collection_id TO 3500;
SET documentdb.next_collection_index_id TO 3500;
SELECT 1 FROM documentdb_api.drop_collection('db', 'bsonorderby');
 ?column? 
---------------------------------------------------------------------
        1
(1 row)

SELECT documentdb_api.create_collection('db', 'bsonorderby');
NOTICE:  creating collection
 create_collection 
---------------------------------------------------------------------
 t
(1 row)

SELECT documentdb_distributed_test_helpers.drop_primary_key('db', 'bsonorderby');
 drop_primary_key 
---------------------------------------------------------------------
 
(1 row)

\set prevEcho :ECHO
\set ECHO none
BEGIN;
set local enable_seqscan to off;
set local enable_bitmapscan to off;
set local documentdb.forceUseIndexIfAvailable to on;
\i sql/bson_query_modifier_orderby_tests_core.sql
SET search_path TO documentdb_core,documentdb_api,documentdb_api_catalog,documentdb_api_internal;
/* insert paths with nested objects arrays */
SELECT documentdb_api.insert_one('db','bsonorderby', '{"_id": 9, "a" : { "b" : 1 } }', NULL);
                              insert_one                              
---------------------------------------------------------------------
 { "n" : { "$numberInt" : "1" }, "ok" : { "$numberDouble" : "1.0" } }
(1 row)

SELECT documentdb_api.insert_one('db','bsonorderby', '{"_id": 10, "a" : { "b" : [ 0, 1, 2 ] } }', NULL);
                              insert_one                              
---------------------------------------------------------------------
 { "n" : { "$numberInt" : "1" }, "ok" : { "$numberDouble" : "1.0" } }
(1 row)

SELECT documentdb_api.insert_one('db','bsonorderby', '{"_id": 11, "a" : [ { "b": 0 }, { "b": 1 }, { "b": 3.0 }] }', NULL);
                              insert_one                              
---------------------------------------------------------------------
 { "n" : { "$numberInt" : "1" }, "ok" : { "$numberDouble" : "1.0" } }
(1 row)

SELECT documentdb_api.insert_one('db','bsonorderby', '{"_id": 12, "a" : [ { "b": [-1, 1, 2] }, { "b": [0, 1, 2] }, { "b": [0, 1, 7] }] }', NULL);
                              insert_one                              
---------------------------------------------------------------------
 { "n" : { "$numberInt" : "1" }, "ok" : { "$numberDouble" : "1.0" } }
(1 row)

SELECT documentdb_api.insert_one('db','bsonorderby', '{"_id": 13, "a" : [ { "b": [[-1, 1, 2]] }, { "b": [[0, 1, 2]] }, { "b": [[0, 1, 7]] }] }', NULL);
                              insert_one                              
---------------------------------------------------------------------
 { "n" : { "$numberInt" : "1" }, "ok" : { "$numberDouble" : "1.0" } }
(1 row)

SELECT object_id, document FROM documentdb_api.collection('db', 'bsonorderby') ORDER BY bson_orderby(document, '{ "a.b": 1 }') ASC;
            object_id             |                                                                                                                                                           document                                                                                                                                                           
---------------------------------------------------------------------
 { "" : { "$numberInt" : "12" } } | { "_id" : { "$numberInt" : "12" }, "a" : [ { "b" : [ { "$numberInt" : "-1" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] }, { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] }, { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "7" } ] } ] }
 { "" : { "$numberInt" : "10" } } | { "_id" : { "$numberInt" : "10" }, "a" : { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] } }
 { "" : { "$numberInt" : "11" } } | { "_id" : { "$numberInt" : "11" }, "a" : [ { "b" : { "$numberInt" : "0" } }, { "b" : { "$numberInt" : "1" } }, { "b" : { "$numberDouble" : "3.0" } } ] }
 { "" : { "$numberInt" : "9" } }  | { "_id" : { "$numberInt" : "9" }, "a" : { "b" : { "$numberInt" : "1" } } }
 { "" : { "$numberInt" : "13" } } | { "_id" : { "$numberInt" : "13" }, "a" : [ { "b" : [ [ { "$numberInt" : "-1" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] ] }, { "b" : [ [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] ] }, { "b" : [ [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "7" } ] ] } ] }
(5 rows)

SELECT object_id, document FROM documentdb_api.collection('db', 'bsonorderby') ORDER BY bson_orderby(document, '{ "a.b": -1 }') DESC;
            object_id             |                                                                                                                                                           document                                                                                                                                                           
---------------------------------------------------------------------
 { "" : { "$numberInt" : "13" } } | { "_id" : { "$numberInt" : "13" }, "a" : [ { "b" : [ [ { "$numberInt" : "-1" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] ] }, { "b" : [ [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] ] }, { "b" : [ [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "7" } ] ] } ] }
 { "" : { "$numberInt" : "12" } } | { "_id" : { "$numberInt" : "12" }, "a" : [ { "b" : [ { "$numberInt" : "-1" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] }, { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] }, { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "7" } ] } ] }
 { "" : { "$numberInt" : "11" } } | { "_id" : { "$numberInt" : "11" }, "a" : [ { "b" : { "$numberInt" : "0" } }, { "b" : { "$numberInt" : "1" } }, { "b" : { "$numberDouble" : "3.0" } } ] }
 { "" : { "$numberInt" : "10" } } | { "_id" : { "$numberInt" : "10" }, "a" : { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] } }
 { "" : { "$numberInt" : "9" } }  | { "_id" : { "$numberInt" : "9" }, "a" : { "b" : { "$numberInt" : "1" } } }
(5 rows)

SELECT object_id, document FROM documentdb_api.collection('db', 'bsonorderby') ORDER BY bson_orderby(document, '{ "a.b.0": -1 }') DESC;
            object_id             |                                                                                                                                                           document                                                                                                                                                           
---------------------------------------------------------------------
 { "" : { "$numberInt" : "10" } } | { "_id" : { "$numberInt" : "10" }, "a" : { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] } }
 { "" : { "$numberInt" : "12" } } | { "_id" : { "$numberInt" : "12" }, "a" : [ { "b" : [ { "$numberInt" : "-1" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] }, { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] }, { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "7" } ] } ] }
 { "" : { "$numberInt" : "9" } }  | { "_id" : { "$numberInt" : "9" }, "a" : { "b" : { "$numberInt" : "1" } } }
 { "" : { "$numberInt" : "11" } } | { "_id" : { "$numberInt" : "11" }, "a" : [ { "b" : { "$numberInt" : "0" } }, { "b" : { "$numberInt" : "1" } }, { "b" : { "$numberDouble" : "3.0" } } ] }
 { "" : { "$numberInt" : "13" } } | { "_id" : { "$numberInt" : "13" }, "a" : [ { "b" : [ [ { "$numberInt" : "-1" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] ] }, { "b" : [ [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] ] }, { "b" : [ [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "7" } ] ] } ] }
(5 rows)

SELECT object_id, document FROM documentdb_api.collection('db', 'bsonorderby') ORDER BY bson_orderby(document, '{ "a.b.1": 1 }') ASC;
            object_id             |                                                                                                                                                           document                                                                                                                                                           
---------------------------------------------------------------------
 { "" : { "$numberInt" : "9" } }  | { "_id" : { "$numberInt" : "9" }, "a" : { "b" : { "$numberInt" : "1" } } }
 { "" : { "$numberInt" : "11" } } | { "_id" : { "$numberInt" : "11" }, "a" : [ { "b" : { "$numberInt" : "0" } }, { "b" : { "$numberInt" : "1" } }, { "b" : { "$numberDouble" : "3.0" } } ] }
 { "" : { "$numberInt" : "13" } } | { "_id" : { "$numberInt" : "13" }, "a" : [ { "b" : [ [ { "$numberInt" : "-1" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] ] }, { "b" : [ [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] ] }, { "b" : [ [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "7" } ] ] } ] }
 { "" : { "$numberInt" : "10" } } | { "_id" : { "$numberInt" : "10" }, "a" : { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] } }
 { "" : { "$numberInt" : "12" } } | { "_id" : { "$numberInt" : "12" }, "a" : [ { "b" : [ { "$numberInt" : "-1" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] }, { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] }, { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "7" } ] } ] }
(5 rows)

SELECT object_id, document FROM documentdb_api.collection('db', 'bsonorderby') ORDER BY bson_orderby(document, '{ "a.b": 1 }') ASC, bson_orderby(document, '{ "a.b.0": 1 }') ASC;
            object_id             |                                                                                                                                                           document                                                                                                                                                           
---------------------------------------------------------------------
 { "" : { "$numberInt" : "12" } } | { "_id" : { "$numberInt" : "12" }, "a" : [ { "b" : [ { "$numberInt" : "-1" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] }, { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] }, { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "7" } ] } ] }
 { "" : { "$numberInt" : "11" } } | { "_id" : { "$numberInt" : "11" }, "a" : [ { "b" : { "$numberInt" : "0" } }, { "b" : { "$numberInt" : "1" } }, { "b" : { "$numberDouble" : "3.0" } } ] }
 { "" : { "$numberInt" : "10" } } | { "_id" : { "$numberInt" : "10" }, "a" : { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] } }
 { "" : { "$numberInt" : "9" } }  | { "_id" : { "$numberInt" : "9" }, "a" : { "b" : { "$numberInt" : "1" } } }
 { "" : { "$numberInt" : "13" } } | { "_id" : { "$numberInt" : "13" }, "a" : [ { "b" : [ [ { "$numberInt" : "-1" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] ] }, { "b" : [ [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] ] }, { "b" : [ [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "7" } ] ] } ] }
(5 rows)

SELECT object_id, document FROM documentdb_api.collection('db', 'bsonorderby') ORDER BY bson_orderby(document, '{ "a.b": 1 }') ASC, bson_orderby(document, '{ "a.b.0": -1 }') DESC;
            object_id             |                                                                                                                                                           document                                                                                                                                                           
---------------------------------------------------------------------
 { "" : { "$numberInt" : "12" } } | { "_id" : { "$numberInt" : "12" }, "a" : [ { "b" : [ { "$numberInt" : "-1" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] }, { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] }, { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "7" } ] } ] }
 { "" : { "$numberInt" : "10" } } | { "_id" : { "$numberInt" : "10" }, "a" : { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] } }
 { "" : { "$numberInt" : "11" } } | { "_id" : { "$numberInt" : "11" }, "a" : [ { "b" : { "$numberInt" : "0" } }, { "b" : { "$numberInt" : "1" } }, { "b" : { "$numberDouble" : "3.0" } } ] }
 { "" : { "$numberInt" : "9" } }  | { "_id" : { "$numberInt" : "9" }, "a" : { "b" : { "$numberInt" : "1" } } }
 { "" : { "$numberInt" : "13" } } | { "_id" : { "$numberInt" : "13" }, "a" : [ { "b" : [ [ { "$numberInt" : "-1" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] ] }, { "b" : [ [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] ] }, { "b" : [ [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "7" } ] ] } ] }
(5 rows)

SELECT object_id, document FROM documentdb_api.collection('db', 'bsonorderby') WHERE document @@ '{ "a.b": { "$gt": 0 } }' ORDER BY bson_orderby(document, '{ "a.b": 1 }');
            object_id             |                                                                                                                                                     document                                                                                                                                                     
---------------------------------------------------------------------
 { "" : { "$numberInt" : "12" } } | { "_id" : { "$numberInt" : "12" }, "a" : [ { "b" : [ { "$numberInt" : "-1" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] }, { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] }, { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "7" } ] } ] }
 { "" : { "$numberInt" : "10" } } | { "_id" : { "$numberInt" : "10" }, "a" : { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] } }
 { "" : { "$numberInt" : "11" } } | { "_id" : { "$numberInt" : "11" }, "a" : [ { "b" : { "$numberInt" : "0" } }, { "b" : { "$numberInt" : "1" } }, { "b" : { "$numberDouble" : "3.0" } } ] }
 { "" : { "$numberInt" : "9" } }  | { "_id" : { "$numberInt" : "9" }, "a" : { "b" : { "$numberInt" : "1" } } }
(4 rows)

SELECT object_id, document FROM documentdb_api.collection('db', 'bsonorderby') WHERE document @@ '{ "a.b.0": { "$gte": 0 } }' ORDER BY bson_orderby(document, '{ "a.b": 1 }');
            object_id             |                                                                                                                                                     document                                                                                                                                                     
---------------------------------------------------------------------
 { "" : { "$numberInt" : "12" } } | { "_id" : { "$numberInt" : "12" }, "a" : [ { "b" : [ { "$numberInt" : "-1" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] }, { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] }, { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "7" } ] } ] }
 { "" : { "$numberInt" : "10" } } | { "_id" : { "$numberInt" : "10" }, "a" : { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] } }
(2 rows)

SELECT object_id, document FROM documentdb_api.collection('db', 'bsonorderby') WHERE document @@ '{ "a.b.0": { "$gte": 0 } }' ORDER BY bson_orderby(document, '{ "a.b": 1 }'), bson_orderby(document, '{ "a.b.0": 1 }');
            object_id             |                                                                                                                                                     document                                                                                                                                                     
---------------------------------------------------------------------
 { "" : { "$numberInt" : "12" } } | { "_id" : { "$numberInt" : "12" }, "a" : [ { "b" : [ { "$numberInt" : "-1" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] }, { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] }, { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "7" } ] } ] }
 { "" : { "$numberInt" : "10" } } | { "_id" : { "$numberInt" : "10" }, "a" : { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] } }
(2 rows)

SELECT object_id, document FROM documentdb_api.collection('db', 'bsonorderby') WHERE document @@ '{ "a.b.0": { "$gte": 0 } }' ORDER BY bson_orderby(document, '{ "a.b": 1 }'), bson_orderby(document, '{ "a.b.1": 1 }');
            object_id             |                                                                                                                                                     document                                                                                                                                                     
---------------------------------------------------------------------
 { "" : { "$numberInt" : "12" } } | { "_id" : { "$numberInt" : "12" }, "a" : [ { "b" : [ { "$numberInt" : "-1" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] }, { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] }, { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "7" } ] } ] }
 { "" : { "$numberInt" : "10" } } | { "_id" : { "$numberInt" : "10" }, "a" : { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] } }
(2 rows)

SELECT object_id, document FROM documentdb_api.collection('db', 'bsonorderby') WHERE document @@ '{ "a.b": { "$gte": 0 } }' ORDER BY bson_orderby(document, '{ "a.b": 1 }'), bson_orderby(document, '{ "a.b.1": 1 }');
            object_id             |                                                                                                                                                     document                                                                                                                                                     
---------------------------------------------------------------------
 { "" : { "$numberInt" : "12" } } | { "_id" : { "$numberInt" : "12" }, "a" : [ { "b" : [ { "$numberInt" : "-1" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] }, { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] }, { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "7" } ] } ] }
 { "" : { "$numberInt" : "11" } } | { "_id" : { "$numberInt" : "11" }, "a" : [ { "b" : { "$numberInt" : "0" } }, { "b" : { "$numberInt" : "1" } }, { "b" : { "$numberDouble" : "3.0" } } ] }
 { "" : { "$numberInt" : "10" } } | { "_id" : { "$numberInt" : "10" }, "a" : { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] } }
 { "" : { "$numberInt" : "9" } }  | { "_id" : { "$numberInt" : "9" }, "a" : { "b" : { "$numberInt" : "1" } } }
(4 rows)

SELECT object_id, document FROM documentdb_api.collection('db', 'bsonorderby') WHERE document @@ '{ "a.b": { "$in": [ 0, 1, 2, 3 ] } }' ORDER BY bson_orderby(document, '{ "a.b": 1 }');
            object_id             |                                                                                                                                                     document                                                                                                                                                     
---------------------------------------------------------------------
 { "" : { "$numberInt" : "12" } } | { "_id" : { "$numberInt" : "12" }, "a" : [ { "b" : [ { "$numberInt" : "-1" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] }, { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] }, { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "7" } ] } ] }
 { "" : { "$numberInt" : "10" } } | { "_id" : { "$numberInt" : "10" }, "a" : { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] } }
 { "" : { "$numberInt" : "11" } } | { "_id" : { "$numberInt" : "11" }, "a" : [ { "b" : { "$numberInt" : "0" } }, { "b" : { "$numberInt" : "1" } }, { "b" : { "$numberDouble" : "3.0" } } ] }
 { "" : { "$numberInt" : "9" } }  | { "_id" : { "$numberInt" : "9" }, "a" : { "b" : { "$numberInt" : "1" } } }
(4 rows)

PREPARE q1(bson) AS SELECT object_id, document FROM documentdb_api.collection('db', 'bsonorderby') ORDER BY bson_orderby(document, $1);
PREPARE q1desc(bson) AS SELECT object_id, document FROM documentdb_api.collection('db', 'bsonorderby') ORDER BY bson_orderby(document, $1) DESC;
EXECUTE q1('{ "a.b.0": 1 }');
            object_id             |                                                                                                                                                           document                                                                                                                                                           
---------------------------------------------------------------------
 { "" : { "$numberInt" : "9" } }  | { "_id" : { "$numberInt" : "9" }, "a" : { "b" : { "$numberInt" : "1" } } }
 { "" : { "$numberInt" : "11" } } | { "_id" : { "$numberInt" : "11" }, "a" : [ { "b" : { "$numberInt" : "0" } }, { "b" : { "$numberInt" : "1" } }, { "b" : { "$numberDouble" : "3.0" } } ] }
 { "" : { "$numberInt" : "13" } } | { "_id" : { "$numberInt" : "13" }, "a" : [ { "b" : [ [ { "$numberInt" : "-1" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] ] }, { "b" : [ [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] ] }, { "b" : [ [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "7" } ] ] } ] }
 { "" : { "$numberInt" : "12" } } | { "_id" : { "$numberInt" : "12" }, "a" : [ { "b" : [ { "$numberInt" : "-1" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] }, { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] }, { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "7" } ] } ] }
 { "" : { "$numberInt" : "10" } } | { "_id" : { "$numberInt" : "10" }, "a" : { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] } }
(5 rows)

EXECUTE q1desc('{ "a.b.0": -1 }');
            object_id             |                                                                                                                                                           document                                                                                                                                                           
---------------------------------------------------------------------
 { "" : { "$numberInt" : "10" } } | { "_id" : { "$numberInt" : "10" }, "a" : { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] } }
 { "" : { "$numberInt" : "12" } } | { "_id" : { "$numberInt" : "12" }, "a" : [ { "b" : [ { "$numberInt" : "-1" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] }, { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] }, { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "7" } ] } ] }
 { "" : { "$numberInt" : "9" } }  | { "_id" : { "$numberInt" : "9" }, "a" : { "b" : { "$numberInt" : "1" } } }
 { "" : { "$numberInt" : "11" } } | { "_id" : { "$numberInt" : "11" }, "a" : [ { "b" : { "$numberInt" : "0" } }, { "b" : { "$numberInt" : "1" } }, { "b" : { "$numberDouble" : "3.0" } } ] }
 { "" : { "$numberInt" : "13" } } | { "_id" : { "$numberInt" : "13" }, "a" : [ { "b" : [ [ { "$numberInt" : "-1" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] ] }, { "b" : [ [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] ] }, { "b" : [ [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "7" } ] ] } ] }
(5 rows)

EXECUTE q1('{ "a.b.0": 1 }');
            object_id             |                                                                                                                                                           document                                                                                                                                                           
---------------------------------------------------------------------
 { "" : { "$numberInt" : "9" } }  | { "_id" : { "$numberInt" : "9" }, "a" : { "b" : { "$numberInt" : "1" } } }
 { "" : { "$numberInt" : "11" } } | { "_id" : { "$numberInt" : "11" }, "a" : [ { "b" : { "$numberInt" : "0" } }, { "b" : { "$numberInt" : "1" } }, { "b" : { "$numberDouble" : "3.0" } } ] }
 { "" : { "$numberInt" : "13" } } | { "_id" : { "$numberInt" : "13" }, "a" : [ { "b" : [ [ { "$numberInt" : "-1" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] ] }, { "b" : [ [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] ] }, { "b" : [ [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "7" } ] ] } ] }
 { "" : { "$numberInt" : "12" } } | { "_id" : { "$numberInt" : "12" }, "a" : [ { "b" : [ { "$numberInt" : "-1" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] }, { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] }, { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "7" } ] } ] }
 { "" : { "$numberInt" : "10" } } | { "_id" : { "$numberInt" : "10" }, "a" : { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] } }
(5 rows)

EXECUTE q1desc('{ "a.b.0": -1 }');
            object_id             |                                                                                                                                                           document                                                                                                                                                           
---------------------------------------------------------------------
 { "" : { "$numberInt" : "10" } } | { "_id" : { "$numberInt" : "10" }, "a" : { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] } }
 { "" : { "$numberInt" : "12" } } | { "_id" : { "$numberInt" : "12" }, "a" : [ { "b" : [ { "$numberInt" : "-1" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] }, { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] }, { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "7" } ] } ] }
 { "" : { "$numberInt" : "9" } }  | { "_id" : { "$numberInt" : "9" }, "a" : { "b" : { "$numberInt" : "1" } } }
 { "" : { "$numberInt" : "11" } } | { "_id" : { "$numberInt" : "11" }, "a" : [ { "b" : { "$numberInt" : "0" } }, { "b" : { "$numberInt" : "1" } }, { "b" : { "$numberDouble" : "3.0" } } ] }
 { "" : { "$numberInt" : "13" } } | { "_id" : { "$numberInt" : "13" }, "a" : [ { "b" : [ [ { "$numberInt" : "-1" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] ] }, { "b" : [ [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] ] }, { "b" : [ [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "7" } ] ] } ] }
(5 rows)

EXECUTE q1('{ "a.b.0": 1 }');
            object_id             |                                                                                                                                                           document                                                                                                                                                           
---------------------------------------------------------------------
 { "" : { "$numberInt" : "9" } }  | { "_id" : { "$numberInt" : "9" }, "a" : { "b" : { "$numberInt" : "1" } } }
 { "" : { "$numberInt" : "11" } } | { "_id" : { "$numberInt" : "11" }, "a" : [ { "b" : { "$numberInt" : "0" } }, { "b" : { "$numberInt" : "1" } }, { "b" : { "$numberDouble" : "3.0" } } ] }
 { "" : { "$numberInt" : "13" } } | { "_id" : { "$numberInt" : "13" }, "a" : [ { "b" : [ [ { "$numberInt" : "-1" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] ] }, { "b" : [ [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] ] }, { "b" : [ [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "7" } ] ] } ] }
 { "" : { "$numberInt" : "12" } } | { "_id" : { "$numberInt" : "12" }, "a" : [ { "b" : [ { "$numberInt" : "-1" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] }, { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] }, { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "7" } ] } ] }
 { "" : { "$numberInt" : "10" } } | { "_id" : { "$numberInt" : "10" }, "a" : { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] } }
(5 rows)

EXECUTE q1desc('{ "a.b.0": -1 }');
            object_id             |                                                                                                                                                           document                                                                                                                                                           
---------------------------------------------------------------------
 { "" : { "$numberInt" : "10" } } | { "_id" : { "$numberInt" : "10" }, "a" : { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] } }
 { "" : { "$numberInt" : "12" } } | { "_id" : { "$numberInt" : "12" }, "a" : [ { "b" : [ { "$numberInt" : "-1" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] }, { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] }, { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "7" } ] } ] }
 { "" : { "$numberInt" : "9" } }  | { "_id" : { "$numberInt" : "9" }, "a" : { "b" : { "$numberInt" : "1" } } }
 { "" : { "$numberInt" : "11" } } | { "_id" : { "$numberInt" : "11" }, "a" : [ { "b" : { "$numberInt" : "0" } }, { "b" : { "$numberInt" : "1" } }, { "b" : { "$numberDouble" : "3.0" } } ] }
 { "" : { "$numberInt" : "13" } } | { "_id" : { "$numberInt" : "13" }, "a" : [ { "b" : [ [ { "$numberInt" : "-1" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] ] }, { "b" : [ [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] ] }, { "b" : [ [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "7" } ] ] } ] }
(5 rows)

EXECUTE q1('{ "a.b.0": 1 }');
            object_id             |                                                                                                                                                           document                                                                                                                                                           
---------------------------------------------------------------------
 { "" : { "$numberInt" : "9" } }  | { "_id" : { "$numberInt" : "9" }, "a" : { "b" : { "$numberInt" : "1" } } }
 { "" : { "$numberInt" : "11" } } | { "_id" : { "$numberInt" : "11" }, "a" : [ { "b" : { "$numberInt" : "0" } }, { "b" : { "$numberInt" : "1" } }, { "b" : { "$numberDouble" : "3.0" } } ] }
 { "" : { "$numberInt" : "13" } } | { "_id" : { "$numberInt" : "13" }, "a" : [ { "b" : [ [ { "$numberInt" : "-1" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] ] }, { "b" : [ [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] ] }, { "b" : [ [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "7" } ] ] } ] }
 { "" : { "$numberInt" : "12" } } | { "_id" : { "$numberInt" : "12" }, "a" : [ { "b" : [ { "$numberInt" : "-1" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] }, { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] }, { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "7" } ] } ] }
 { "" : { "$numberInt" : "10" } } | { "_id" : { "$numberInt" : "10" }, "a" : { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] } }
(5 rows)

-- now insert items that are sorted "After" arrays (e.g. boolean)
SELECT documentdb_api.insert_one('db','bsonorderby', '{"_id": 14, "a" : [ { "b": [ true, false ] }, { "b": [ true ] } ] }', NULL);
                              insert_one                              
---------------------------------------------------------------------
 { "n" : { "$numberInt" : "1" }, "ok" : { "$numberDouble" : "1.0" } }
(1 row)

SELECT documentdb_api.insert_one('db','bsonorderby', '{"_id": 15, "a" : { "b": [ [ true, false], [ false, true ] ] } }', NULL);
                              insert_one                              
---------------------------------------------------------------------
 { "n" : { "$numberInt" : "1" }, "ok" : { "$numberDouble" : "1.0" } }
(1 row)

SELECT documentdb_api.insert_one('db','bsonorderby', '{"_id": 16, "a" : { "b": true } }', NULL);
                              insert_one                              
---------------------------------------------------------------------
 { "n" : { "$numberInt" : "1" }, "ok" : { "$numberDouble" : "1.0" } }
(1 row)

-- doesn't consider the array itself but considers nested arrays.
SELECT object_id, document FROM documentdb_api.collection('db', 'bsonorderby') ORDER BY bson_orderby(document, '{ "a.b": 1 }');
            object_id             |                                                                                                                                                           document                                                                                                                                                           
---------------------------------------------------------------------
 { "" : { "$numberInt" : "12" } } | { "_id" : { "$numberInt" : "12" }, "a" : [ { "b" : [ { "$numberInt" : "-1" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] }, { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] }, { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "7" } ] } ] }
 { "" : { "$numberInt" : "10" } } | { "_id" : { "$numberInt" : "10" }, "a" : { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] } }
 { "" : { "$numberInt" : "11" } } | { "_id" : { "$numberInt" : "11" }, "a" : [ { "b" : { "$numberInt" : "0" } }, { "b" : { "$numberInt" : "1" } }, { "b" : { "$numberDouble" : "3.0" } } ] }
 { "" : { "$numberInt" : "9" } }  | { "_id" : { "$numberInt" : "9" }, "a" : { "b" : { "$numberInt" : "1" } } }
 { "" : { "$numberInt" : "13" } } | { "_id" : { "$numberInt" : "13" }, "a" : [ { "b" : [ [ { "$numberInt" : "-1" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] ] }, { "b" : [ [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] ] }, { "b" : [ [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "7" } ] ] } ] }
 { "" : { "$numberInt" : "15" } } | { "_id" : { "$numberInt" : "15" }, "a" : { "b" : [ [ true, false ], [ false, true ] ] } }
 { "" : { "$numberInt" : "14" } } | { "_id" : { "$numberInt" : "14" }, "a" : [ { "b" : [ true, false ] }, { "b" : [ true ] } ] }
 { "" : { "$numberInt" : "16" } } | { "_id" : { "$numberInt" : "16" }, "a" : { "b" : true } }
(8 rows)

SELECT object_id, document FROM documentdb_api.collection('db', 'bsonorderby') ORDER BY bson_orderby(document, '{ "a.b": -1 }') DESC;
            object_id             |                                                                                                                                                           document                                                                                                                                                           
---------------------------------------------------------------------
 { "" : { "$numberInt" : "14" } } | { "_id" : { "$numberInt" : "14" }, "a" : [ { "b" : [ true, false ] }, { "b" : [ true ] } ] }
 { "" : { "$numberInt" : "16" } } | { "_id" : { "$numberInt" : "16" }, "a" : { "b" : true } }
 { "" : { "$numberInt" : "15" } } | { "_id" : { "$numberInt" : "15" }, "a" : { "b" : [ [ true, false ], [ false, true ] ] } }
 { "" : { "$numberInt" : "13" } } | { "_id" : { "$numberInt" : "13" }, "a" : [ { "b" : [ [ { "$numberInt" : "-1" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] ] }, { "b" : [ [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] ] }, { "b" : [ [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "7" } ] ] } ] }
 { "" : { "$numberInt" : "12" } } | { "_id" : { "$numberInt" : "12" }, "a" : [ { "b" : [ { "$numberInt" : "-1" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] }, { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] }, { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "7" } ] } ] }
 { "" : { "$numberInt" : "11" } } | { "_id" : { "$numberInt" : "11" }, "a" : [ { "b" : { "$numberInt" : "0" } }, { "b" : { "$numberInt" : "1" } }, { "b" : { "$numberDouble" : "3.0" } } ] }
 { "" : { "$numberInt" : "10" } } | { "_id" : { "$numberInt" : "10" }, "a" : { "b" : [ { "$numberInt" : "0" }, { "$numberInt" : "1" }, { "$numberInt" : "2" } ] } }
 { "" : { "$numberInt" : "9" } }  | { "_id" : { "$numberInt" : "9" }, "a" : { "b" : { "$numberInt" : "1" } } }
(8 rows)

-- sort order across types (see sorta.js).
SELECT documentdb_api.insert_one('db', 'sortordertests', '{ "_id": 0, "a": { "$minKey": 1 } }');
psql:sql/bson_query_modifier_orderby_tests_core.sql:61: NOTICE:  creating collection
                              insert_one                              
---------------------------------------------------------------------
 { "n" : { "$numberInt" : "1" }, "ok" : { "$numberDouble" : "1.0" } }
(1 row)

SELECT documentdb_api.insert_one('db', 'sortordertests', '{ "_id": 3, "a": null }');
                              insert_one                              
---------------------------------------------------------------------
 { "n" : { "$numberInt" : "1" }, "ok" : { "$numberDouble" : "1.0" } }
(1 row)

SELECT documentdb_api.insert_one('db', 'sortordertests', '{ "_id": 1, "a": [] }');
                              insert_one                              
---------------------------------------------------------------------
 { "n" : { "$numberInt" : "1" }, "ok" : { "$numberDouble" : "1.0" } }
(1 row)

SELECT documentdb_api.insert_one('db', 'sortordertests', '{ "_id": 7, "a": [ 2 ] }');
                              insert_one                              
---------------------------------------------------------------------
 { "n" : { "$numberInt" : "1" }, "ok" : { "$numberDouble" : "1.0" } }
(1 row)

SELECT documentdb_api.insert_one('db', 'sortordertests', '{ "_id": 4 }');
                              insert_one                              
---------------------------------------------------------------------
 { "n" : { "$numberInt" : "1" }, "ok" : { "$numberDouble" : "1.0" } }
(1 row)

SELECT documentdb_api.insert_one('db', 'sortordertests', '{ "_id": 5, "a": null }');
                              insert_one                              
---------------------------------------------------------------------
 { "n" : { "$numberInt" : "1" }, "ok" : { "$numberDouble" : "1.0" } }
(1 row)

SELECT documentdb_api.insert_one('db', 'sortordertests', '{ "_id": 2, "a": [] }');
                              insert_one                              
---------------------------------------------------------------------
 { "n" : { "$numberInt" : "1" }, "ok" : { "$numberDouble" : "1.0" } }
(1 row)

SELECT documentdb_api.insert_one('db', 'sortordertests', '{ "_id": 6, "a": 1 }');
                              insert_one                              
---------------------------------------------------------------------
 { "n" : { "$numberInt" : "1" }, "ok" : { "$numberDouble" : "1.0" } }
(1 row)

SELECT documentdb_api.insert_one('db', 'sortordertests', '{ "_id": 8, "a": { "$maxKey": 1 } }');
                              insert_one                              
---------------------------------------------------------------------
 { "n" : { "$numberInt" : "1" }, "ok" : { "$numberDouble" : "1.0" } }
(1 row)

SELECT object_id, document FROM documentdb_api.collection('db', 'sortordertests') ORDER BY bson_orderby(document, '{ "a": 1 }'), object_id;
            object_id            |                               document                               
---------------------------------------------------------------------
 { "" : { "$numberInt" : "0" } } | { "_id" : { "$numberInt" : "0" }, "a" : { "$minKey" : 1 } }
 { "" : { "$numberInt" : "1" } } | { "_id" : { "$numberInt" : "1" }, "a" : [  ] }
 { "" : { "$numberInt" : "2" } } | { "_id" : { "$numberInt" : "2" }, "a" : [  ] }
 { "" : { "$numberInt" : "3" } } | { "_id" : { "$numberInt" : "3" }, "a" : null }
 { "" : { "$numberInt" : "4" } } | { "_id" : { "$numberInt" : "4" } }
 { "" : { "$numberInt" : "5" } } | { "_id" : { "$numberInt" : "5" }, "a" : null }
 { "" : { "$numberInt" : "6" } } | { "_id" : { "$numberInt" : "6" }, "a" : { "$numberInt" : "1" } }
 { "" : { "$numberInt" : "7" } } | { "_id" : { "$numberInt" : "7" }, "a" : [ { "$numberInt" : "2" } ] }
 { "" : { "$numberInt" : "8" } } | { "_id" : { "$numberInt" : "8" }, "a" : { "$maxKey" : 1 } }
(9 rows)

SELECT bson_orderby('{ "b": 1 }', '{ "b": -1 }') = '{ "b": 1 }';
 ?column? 
---------------------------------------------------------------------
 t
(1 row)

SELECT bson_orderby('{ "b": 1 }', '{ "b": 1 }') = '{ "b": 1 }';
 ?column? 
---------------------------------------------------------------------
 t
(1 row)

SELECT bson_orderby('{ "b": { "c" : 1 } }', '{ "b": -1 }') = '{ "b": { "c": 1 } }';
 ?column? 
---------------------------------------------------------------------
 t
(1 row)

SELECT bson_orderby('{ "b": { "c" : 1 } }', '{ "b": 1 }') = '{ "b": { "c": 1 } }';
 ?column? 
---------------------------------------------------------------------
 t
(1 row)

SELECT bson_orderby('{ "b": [ { "c" : 1 } ] }', '{ "b": -1 }') = '{ "b" : { "c": 1 } }';
 ?column? 
---------------------------------------------------------------------
 t
(1 row)

SELECT bson_orderby('{ "b": [ { "c" : 1 } ] }', '{ "b": 1 }') = '{ "b" : { "c": 1 } }';
 ?column? 
---------------------------------------------------------------------
 t
(1 row)

SELECT bson_orderby('{ "b": [ { "c" : 1 }, { "c": 2 } ] }', '{ "b": -1 }') = '{ "b" : { "c": 2 } }';
 ?column? 
---------------------------------------------------------------------
 t
(1 row)

SELECT bson_orderby('{ "b": [ { "c" : 1 }, { "c": 2 } ] }', '{ "b": 1 }') = '{ "b" : { "c": 1 } }';
 ?column? 
---------------------------------------------------------------------
 t
(1 row)

SELECT bson_orderby('{ "b": [ 1, 2, 3 ] }', '{ "b": -1 }') = '{ "b": 3 }';
 ?column? 
---------------------------------------------------------------------
 t
(1 row)

SELECT bson_orderby('{ "b": [ 1, 2, 3 ] }', '{ "b": 1 }') = '{ "b": 1 }';
 ?column? 
---------------------------------------------------------------------
 t
(1 row)

SELECT bson_orderby('{ "b": [ true, false, false ] }', '{ "b": -1 }') = '{ "b": true }';
 ?column? 
---------------------------------------------------------------------
 t
(1 row)

SELECT bson_orderby('{ "b": [  true, false, false ] }', '{ "b": 1 }') = '{ "b": false }';
 ?column? 
---------------------------------------------------------------------
 t
(1 row)

SELECT bson_orderby('{ "b": [ [1], [2], [3] ] }', '{ "b": -1 }') = '{ "b": [3] }';
 ?column? 
---------------------------------------------------------------------
 t
(1 row)

SELECT bson_orderby('{ "b": [ [1], [2], [3] ] }', '{ "b": 1 }') = '{ "b": [1] }';
 ?column? 
---------------------------------------------------------------------
 t
(1 row)

SELECT bson_orderby('{ "b": [ 1, true, "someString" ] }', '{ "b": -1 }') = '{ "b": true }';
 ?column? 
---------------------------------------------------------------------
 t
(1 row)

SELECT bson_orderby('{ "b": [ 1, true, "someString" ] }', '{ "b": 1 }') = '{ "b": 1 }';
 ?column? 
---------------------------------------------------------------------
 t
(1 row)

SELECT bson_orderby('{ "b": [ 1, { "c": 2 }, "someString" ] }', '{ "b.c": -1 }') = '{ "b.c": 2 }';
 ?column? 
---------------------------------------------------------------------
 t
(1 row)

ROLLBACK;
